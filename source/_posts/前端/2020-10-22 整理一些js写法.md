---
title: 整理一些js写法
date: 2020-10-22 09:57:27
tags: ['前端', 'javascript']
categories: 前端
id: several-js-grammar
reward: true
---

# 整理一些js写法

### 从元素为对象的数组中提取出对象的某属性为x的快速写法，摘自vuex教程

说到底是Array的find()、filter()方法

find返回的是数组里第一个符合条件的选项，

filter返回的是数组里符合条件的选项集合，是一个数组

```js
const store = new Vuex.Store({
  state: {
    todos: [
      { id: 1, text: '...', done: true },
      { id: 2, text: '...', done: false }
    ]
  },
  getters: {
    doneTodos: state => {
      return state.todos.filter(todo => todo.done)
    }
  }
})

getters: {
  // ...
  getTodoById: (state) => (id) => {
    return state.todos.find(todo => todo.id === id)
  }
}
```

filter 其他用法

去掉数组中值为index的项目

```javascript
this.arr = this.arr.filter((item) => item !== index);
```

判断数组中有没有值为index的项目

```javascript
this.arr.filter((item) => item === index).length !== 0
```

反转对象的key和value的值，如果直接将对象传进去，将会改变原有对象，建议传{...obj}进去

```javascript
reverseKV(obj) {
 Object.keys(obj).forEach(k => {
  let value = obj[k];
  obj[value] = k;
  delete obj[k];
 });
 return obj;
}
```

查找数组中，对象某个属性值为val的索引(index)

```javascript
findElem(arrayToSearch, attr, val) {
 for (let i = 0; i < arrayToSearch.length; i++) {
  if (arrayToSearch[i][attr] === val) {
   return i;
  }
 }
 return -1;
}
```

判断页面上的字符是否溢出

```javascript
isOverflow(element) {
 return element ? element[0].offsetWidth >= element[0].scrollWidth : false;
}
```

时间格式化

```javascript
timeFormat(value) {
 return value === 0 ? '-' : moment(value).format('YYYY-MM-DD HH:mm:ss');
}
```

事件中的offsetX，offsetY，只有chrome能算准，火狐firefox会时常为0，这时候就需要换一种算法

```javascript
//firefox event.offsetX 时常为0
// let ox = event.offsetX; //
// let oy = event.offsetY;
let srcObj = event.target || event.srcElement;
let ox = event.offsetX || (event.clientX - srcObj.getBoundingClientRect().left);
let oy = event.offsetY || (event.clientY - srcObj.getBoundingClientRect().top);
```